## 问题和练习 {.unlisted .unnumbered}

1. **CPU核心时钟和参考时钟的区别是什么？**

    CPU核心时钟表示处理器内核运行的频率，单位为GHz。它决定了处理器在每个时钟周期内可以执行的指令数量。参考时钟是系统中一个基准时钟信号，通常比核心时钟频率更低，用于同步系统中的各个组件。

2. **已执行指令和已完成指令的区别是什么？**

    已执行指令是指已经进入流水线并且开始执行的指令。已完成指令是指已经成功完成所有执行阶段并写回结果的指令。已执行指令的数量可能大于已完成指令的数量，因为有些指令可能由于分支错误、数据依赖等原因无法完成。

3. **当您增加频率时，IPC 会上升、下降还是保持不变？**

    增加频率不一定意味着IPC会上升。IPC还取决于其他因素，例如指令集架构、缓存命中率、内存带宽等。如果其他因素没有改善，增加频率只会提高时钟周期的执行速度，但并不会增加每个周期内完成的指令数量，因此IPC可能会保持不变甚至下降。

4. **请看表 {@tbl:perf_metrics} 中的 `DRAM BW Use` 公式，为什么会有一个常数 `64`？**

    公式中的常数 `64` 可能代表了缓存行的大小，以字节为单位。DRAM 带宽使用率计算的是每秒从内存中读取或写入的数据量，除以缓存行大小是为了将单位转换为缓存行访问次数。

5. **使用 MLC、stream 或其他工具测量您开发/基准测试机器上的缓存层次结构和内存的带宽和延迟。**

    这道练习要求您使用性能分析工具测量计算机的缓存和内存性能。您可以使用不同的工具，例如 MLC (Memory Latency Checker)、stream 等，来测量内存带宽和延迟。

6. **运行您每天使用的应用程序。收集性能指标。有什么让你惊讶的吗？**

    这道练习鼓励您分析日常使用的应用程序的性能。您可以使用性能分析工具收集诸如 CPU 使用率、内存使用率、磁盘 I/O 等指标。通过分析这些指标，您可以发现应用程序性能瓶颈并进行优化。

## 产能规划练习

假设您是案例研究中基准测试的四个应用程序的所有者。您的公司管理层要求您为每个应用程序构建小型计算集群，主要目标是最大化性能（吞吐量）。给您的预算有限，但足以购买 1 台用于运行每个工作负载的中端服务器系统（Mac Studio、Supermicro/Dell/HPE 服务器机架等）或 1 台高端台式机（带超频 CPU、液体冷却、顶级 GPU、快速 DRAM），共计 4 台机器。它们可以是所有四种不同的系统。此外，您可以用这笔钱购买 3-4 台低端系统，选择权由您决定。管理层希望将每个应用程序的成本控制在 10,000 美元以下，但如果您能证明开支合理，他们可以灵活调整 (10-20%)。假设 Stockfish 仍然是单线程的。再次查看四个应用程序的性能特征，并写下您将为每个工作负载购买哪些计算机部件（CPU、内存、如有必要，还有独立 GPU）。您将优先考虑哪些规格参数？您将在哪里使用最昂贵的部件，您可以在哪里节省资金？请尽可能详细地描述，并在网上搜索确切的组件及其价格。考虑系统的所有组件：主板、磁盘驱动器、冷却解决方案、电源分配单元、机架/机箱/塔式机箱等。您将运行哪些额外的性能实验来指导您的决策？

这道练习模拟了为特定应用程序选择硬件的场景。您需要考虑应用程序的性能特征、预算限制以及可用的硬件选项。您需要权衡不同的因素，例如 CPU 速度、内存容量、存储速度等，以找到最适合应用程序需求的配置。